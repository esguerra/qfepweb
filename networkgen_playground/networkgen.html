<!doctype html>
<HTML>
<HEAD>
  <meta charset="utf-8" />
  <TITLE>FEP Network</TITLE>

  <!-- NPM (http://visjs.org/index.html#download_install): -->
  <!-- <script type="text/javascript" src="node_modules/vis/dist/vis.min.js"></script> -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>

  <!-- Needed for JSON file import (https://stackoverflow.com/questions/33392557/vis-js-simple-example-edges-do-not-show): -->
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <!-- http://visjs.org/index.html#download_install -->
  <!-- <link rel="stylesheet" type="text/css" href="node_modules/vis/dist/vis.css"> -->
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css">

  <style type="text/css">
    #mynetwork {
        /* width: 600px; */
        width: 100%;
        height: 600px;
        border: 2px solid lightgray;
    }
/*    undo/redo button: */
    #button_undo,
    #button_redo {
      position: relative;
      display: inline-block;
      padding-left: 6px;
      padding-right: 6px;
      padding-top: 1px;
      padding-bottom: 1px;
      color: #878787;
      cursor: pointer;
    }

    #button_undo:hover,
    #button_redo:hover {
      background-color: #dadada;
}
      
    </style>
</HEAD>

<BODY>

<div id="mynetwork"></div>

<!-- Add an invisible <div> element to the document, to hold the JSON data: -->
<div id="networkJSON-results" class="results" style="display:none"></div>

<script type="text/javascript">

  // -------------------------------------------------------------------------
  // OPTIONS:

  // http://visjs.org/docs/network/#modules
  // http://visjs.org/docs/network/edges.html#
  // http://visjs.org/docs/network/physics.html#

var options = {
  // ------------------------------------
  // GENERAL
  nodes: {
  // could also make write PNGs as circular images, then set shape : image and omit size: n.
  // probably should do this. node clicking is inconsistent currently.
  //shape: "image",
  borderWidth: 1,
  shape: "image",
  shapeProperties: {
     useBorderWithImage : true
  },
  size: 120,
  font : {
    size : 30,
    color : 'blue'
  },
  color: {
    border: "#222222",
    background: "white",
    highlight: {
        border: '#2B7CE9',
        background: "white"
        }
  }},
  "edges": {
    "smooth": false
  },
  // ------------------------------------
  // PHYSICS
  "physics": {
    "hierarchicalRepulsion": {
      "centralGravity": 0,
      "springLength": 0.3,
      "nodeDistance": 450,
      "damping": 0.13
    },
    "minVelocity": 0.76,
    "solver": "hierarchicalRepulsion",
    "timestep": 0.7
  },
  // ------------------------------------
  // MANIPULATION
  manipulation: {
    addNode : false,
    addEdge: function (data, callback) {
          console.log('add edge', data);
          // empty if statement removes add edge to self funtionality.
          if (data.from == data.to) {
//              var r = confirm("Do you want to connect the node to itself?");
//              if (r === true) {
//                  callback(data);
//              }
          }
          else {
              callback(data);
          }
      }
  }
  }

// -------------------------------------------------------------------------
// IMPORT DATA FROM JSON:

var json = $.getJSON("data/graph.json")
  .done(function(data){
    var data = {
      nodes: data.nodes,
      edges: data.edges
    };
    var network = new vis.Network(container, data, options);
    
    // disable physics after loading: https://stackoverflow.com/questions/32403578/stop-vis-js-physics-after-nodes-load-but-allow-drag-able-nodes
    network.on("stabilizationIterationsDone", function () {
        network.setOptions( { physics: false } );
    });
});

var container = document.getElementById('mynetwork');
    
</script>

</BODY>
</HTML>